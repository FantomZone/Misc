{
  "browserRules" : [
    {
      "comment" : "Allow google web access",
      "sourceApp" : "*",
      "urlHost" : "www.google.com",
      "urlPort" : 0,
      "action" : "allow"
    },
    {
      "comment" : "Allow twitchy web access",
      "sourceApp" : "*",
      "urlHost" : "*.twitchy.com",
      "urlPort" : 0,
      "action" : "allow"
    },
    {
      "comment" : "Allow private website access",
      "sourceApp" : "*",
      "urlHost" : "192.168.50.151",
      "urlPort" : 0,
      "action" : "allow"
    },
    {
      "comment" : "Allow facebook website access",
      "sourceApp" : "*",
      "urlHost" : "www.facebook.com",
      "urlPort" : 0,
      "action" : "allow"
    },
    {
      "comment" : "Chrome goes to facebook.com no matter what",
      "sourceApp" : "*",
      "urlHost" : "facebook.com",
      "urlPort" : 0,
      "action" : "allow"
    },
    {
      "comment" : "Chrome if it gets to facebook.com then goes to m.facebook.com",
      "sourceApp" : "*",
      "urlHost" : "m.facebook.com",
      "urlPort" : 0,
      "action" : "allow"
    },
    {
      "comment" : "Proper wildcarding of facebook.com prevents other websites from tracking",
      "sourceApp" : "*",
      "urlHost" : "*.facebook.com",
      "urlPort" : 0,
      "action" : "allow"
    },
    {
      "comment" : "Shorthand to allow youtube",
      "sourceApp" : "*",
      "urlHost" : "*.youtube.com",
      "urlPort" : 0,
      "action" : "allow"
    },
    {
      "comment" : "This rule simply allow a quick check of whether remote rules were loaded",
      "sourceApp" : "*",
      "urlHost" : "www.filterrules.com",
      "urlPort" : 0,
      "action" : "allow"
    },
    {
      "comment" : "All other website traffic is blocked",
      "sourceApp" : "*",
      "urlHost" : "*",
      "urlPort" : 0,
      "action" : "drop"
    }
  ],
  "socketRules" : [
    {
      "comment" : "Don't duplicate browser rules, especially if they conflict, except this as a check",
      "sourceApp" : "*",
      "remoteHost" : "www.google.com",
      "remoteEndpoint" : "*",
      "localEndpoint" : "*",
      "socketFamily" : 2,
      "socketType" : 1,
      "socketProtocol" : 6,
      "action" : "allow"
    },
    {
      "comment" : "For example, here's a conflict",
      "sourceApp" : "*",
      "remoteHost" : "*.twitchy.com",
      "remoteEndpoint" : "*",
      "localEndpoint" : "*",
      "socketFamily" : 2,
      "socketType" : 1,
      "socketProtocol" : 6,
      "action" : "drop"
    },
    {
      "sourceApp" : "*",
      "remoteHost" : "www.facebook.com",
      "remoteEndpoint" : "*",
      "localEndpoint" : "*",
      "socketFamily" : 2,
      "socketType" : 1,
      "socketProtocol" : 6,
      "action" : "allow"
    },
    {
      "comment" : "This had a podcast stream over TLS",
      "sourceApp" : "*",
      "remoteHost" : "13.249.139.42",
      "remoteEndpoint" : "*",
      "localEndpoint" : "*",
      "socketFamily" : 2,
      "socketType" : 1,
      "socketProtocol" : 6,
      "action": "drop"
    },
    {
      "comment" : "Allow all non-blocked TLS traffic, including https (2,1,6 == TCP, 443 == TLS)",
      "sourceApp" : "*",
      "remoteHost" : "*",
      "remoteEndpoint" : "*:443",
      "localEndpoint" : "*",
      "socketFamily" : 2,
      "socketType" : 1,
      "socketProtocol" : 6,
      "action" : "allow"
    },
    {
      "comment" : "Allow all non-blocked TLS traffic, including https (2,1,6 == TCP, 443 == TLS)",
      "sourceApp" : "*",
      "remoteHost" : "*",
      "remoteEndpoint" : "*:443",
      "localEndpoint" : "*",
      "socketFamily" : 2,
      "socketType" : 1,
      "socketProtocol" : 6,
      "action" : "allow"
    },
    {
      "comment" : "Drop all other non-TLS traffic TCP for which there isn't an earlier rule",
      "sourceApp" : "*",
      "remoteHost" : "*",
      "remoteEndpoint" : "*",
      "localEndpoint" : "*",
      "socketFamily" : 2,
      "socketType" : 1,
      "socketProtocol" : 6,
      "action" : "drop"
    },
    {
      "comment" : "Allow DNS (2,2,17 == UDP, 55 == DNS",
      "sourceApp" : "*",
      "remoteHost" : "*",
      "remoteEndpoint" : "*:55",
      "localEndpoint" : "*",
      "socketFamily" : 2,
      "socketType" : 2,
      "socketProtocol" : 17,
      "action" : "drop"
    },
    {
      "comment" : "Allow DNS (2,2,17 == UDP, 55 == DNS",
      "sourceApp" : "*",
      "remoteHost" : "*",
      "remoteEndpoint" : "*",
      "localEndpoint" : "*:55",
      "socketFamily" : 2,
      "socketType" : 2,
      "socketProtocol" : 17,
      "action" : "drop"
    },
    {
      "comment" : "Allow STUN and TFTP (2,2,17 == UDP, 3492 == TFTP/STUN",
      "sourceApp" : "*",
      "remoteHost" : "*",
      "remoteEndpoint" : "*:3492",
      "localEndpoint" : "*",
      "socketFamily" : 2,
      "socketType" : 2,
      "socketProtocol" : 17,
      "action" : "drop"
    },
    {
      "comment" : "Allow DHCP (2,2,17 == UDP, 67 == DHCP server",
      "sourceApp" : "*",
      "remoteHost" : "*",
      "remoteEndpoint" : "*:67",
      "localEndpoint" : "*",
      "socketFamily" : 2,
      "socketType" : 2,
      "socketProtocol" : 17,
      "action" : "drop"
    },
    {
      "comment" : "Allow MDNS (2,2,17 == UDP, 5353 == MDNS",
      "sourceApp" : "*",
      "remoteHost" : "*",
      "remoteEndpoint" : "*:5353",
      "localEndpoint" : "*",
      "socketFamily" : 2,
      "socketType" : 2,
      "socketProtocol" : 17,
      "action" : "drop"
    },
    {
      "comment" : "Block all other UDP",
      "sourceApp" : "*",
      "remoteHost" : "*",
      "remoteEndpoint" : "*",
      "localEndpoint" : "*",
      "socketFamily" : 2,
      "socketType" : 2,
      "socketProtocol" : 17,
      "action" : "drop"
    },
    {
      "comment" : "Block all other UDP",
      "sourceApp" : "*",
      "remoteHost" : "*",
      "remoteEndpoint" : "*",
      "localEndpoint" : "*",
      "socketFamily" : 2,
      "socketType" : 2,
      "socketProtocol" : 17,
      "action" : "drop"
    },
    {
      "comment" : "Block all other socket traffic",
      "sourceApp" : "*",
      "remoteHost" : "*",
      "remoteEndpoint" : "*",
      "localEndpoint" : "*",
      "socketFamily" : 0,
      "socketType" : 0,
      "socketProtocol" : 0,
      "action" : "drop"
    }
  ]
}
